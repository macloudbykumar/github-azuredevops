# .github/workflows/install-apache.yml
name: Install Apache HTTPD

on:
  workflow_dispatch:

jobs:
  setup_httpd:
    runs-on: self-hosted  # CentOS 9 runner assumed
    steps:
      - name: Install Apache HTTPD
        run: |
          sudo dnf install -y httpd
          sudo systemctl enable --now httpd
          sudo firewall-cmd --permanent --add-service=http || true
          sudo firewall-cmd --permanent --add-service=https || true
          sudo firewall-cmd --reload || true
          sudo systemctl status httpd

      - name: Create index.html
        run: |
          echo "<!DOCTYPE html>
          <html>
          <head><title>Apache HTTPD is Running</title></head>
          <body><h1>Welcome to Apache on CentOS 9!</h1></body>
          </html>" > /var/www/html/index.html

      - name: Set permissions on index.html
        run: |
          sudo chown apache:apache /var/www/html/index.html
          sudo chmod 644 /var/www/html/index.html
